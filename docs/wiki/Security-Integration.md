---
layout: default
title: Security Integration
permalink: /security-integration/
---

# Security Integration

## Overview

SecAI Radar integrates with Microsoft Defender and Microsoft Purview to provide enterprise-grade security and compliance capabilities for AI agents.

## Microsoft Defender Integration

### Security Posture Management

Microsoft Defender provides security posture management for agent identities:

**Features**:
- Agent vulnerability scanning
- Security recommendations
- Threat detection
- Incident correlation

**Check Agent Security Posture**:

```http
GET /api/security/agents/{agent_id}/posture
```

**Response**:

```json
{
  "agent_id": "aris_thorne",
  "status": "healthy",
  "vulnerabilities": [],
  "recommendations": [
    {
      "id": "rec-001",
      "title": "Enable MFA for agent identity",
      "severity": "medium"
    }
  ],
  "last_scan": "2025-01-15T10:30:00Z"
}
```

### Threat Detection

Defender detects threats related to agent activities:

**Detect Threats**:

```http
POST /api/security/agents/{agent_id}/threats
Content-Type: application/json

{
  "activity_log": [...]
}
```

**Response**:

```json
{
  "agent_id": "aris_thorne",
  "threats": [
    {
      "severity": "high",
      "type": "unauthorized_access",
      "description": "Unauthorized access attempt detected",
      "timestamp": "2025-01-15T10:30:00Z"
    }
  ]
}
```

### Security Recommendations

Get security recommendations for agents:

**Get Recommendations**:

```http
GET /api/security/agents/{agent_id}/recommendations
```

**Common Recommendations**:
- Enable MFA for agent identity
- Review tool permissions
- Update agent blueprint
- Enable additional monitoring

## Microsoft Purview Integration

### Data Classification

Purview classifies data accessed or generated by agents:

**Classify Data**:

```http
POST /api/security/agents/{agent_id}/classify
Content-Type: application/json

{
  "data_content": "Data to classify",
  "data_type": "output"
}
```

**Response**:

```json
{
  "agent_id": "aris_thorne",
  "data_type": "output",
  "classification": "confidential",
  "labels": ["internal", "agent-generated"],
  "timestamp": "2025-01-15T10:30:00Z"
}
```

**Classification Levels**:
- `public` - Public data
- `internal` - Internal use only
- `confidential` - Confidential data
- `restricted` - Highly restricted data

### Data Loss Prevention

Purview applies DLP policies to agent outputs:

**Apply DLP**:

```http
POST /api/security/agents/{agent_id}/dlp
Content-Type: application/json

{
  "output_text": "Agent output",
  "classification": "confidential"
}
```

**Response**:

```json
{
  "protected_output": "[CONFIDENTIAL] Agent output",
  "dlp_actions": ["watermark", "label"]
}
```

**DLP Actions**:
- Watermarking
- Labeling
- Redaction
- Blocking

### Compliance Monitoring

Purview monitors agent compliance with security frameworks:

**Monitor Compliance**:

```http
GET /api/security/agents/{agent_id}/compliance?framework=NIST
```

**Response**:

```json
{
  "agent_id": "aris_thorne",
  "framework": "NIST",
  "compliance_score": 0.85,
  "status": "compliant",
  "findings": [],
  "last_assessment": "2025-01-15T10:30:00Z"
}
```

**Supported Frameworks**:
- NIST Cybersecurity Framework
- ISO 27001
- CIS Controls
- Azure CAF

## Configuration

### Enable Defender Integration

Set environment variables:

```bash
DEFENDER_ENABLED=true
DEFENDER_ENDPOINT=https://api.securitycenter.microsoft.com
DEFENDER_API_KEY=your-api-key
```

### Enable Purview Integration

Set environment variables:

```bash
PURVIEW_ENABLED=true
PURVIEW_ENDPOINT=https://your-purview.purview.azure.com
```

Use DefaultAzureCredential for authentication.

## Security Best Practices

### Defender Integration

1. **Regular Scans** - Schedule regular security scans
2. **Threat Monitoring** - Monitor threat detection alerts
3. **Recommendations** - Act on security recommendations
4. **Incident Response** - Have incident response plan

### Purview Integration

1. **Data Classification** - Classify all agent data
2. **DLP Policies** - Configure appropriate DLP policies
3. **Compliance Monitoring** - Monitor compliance regularly
4. **Audit Trail** - Maintain audit trail for sensitive data

### General Security

1. **Identity Management** - Use Entra Agent IDs for all agents
2. **Access Control** - Implement least privilege
3. **Monitoring** - Monitor agent activities continuously
4. **Incident Response** - Have incident response procedures

## Troubleshooting

### Defender Not Available

**Problem**: Defender integration not working

**Solution**:
1. Verify `DEFENDER_ENABLED=true`
2. Check API endpoint and key
3. Verify network connectivity
4. Check Defender subscription status

### Purview Not Available

**Problem**: Purview integration not working

**Solution**:
1. Verify `PURVIEW_ENABLED=true`
2. Check endpoint configuration
3. Verify authentication (DefaultAzureCredential)
4. Check Purview account permissions

### Classification Errors

**Problem**: Data classification failing

**Solution**:
1. Verify Purview endpoint
2. Check data format
3. Verify classification rules
4. Review Purview logs

## API Reference

### Security Posture

```http
GET /api/security/agents/{agent_id}/posture
```

### Threat Detection

```http
POST /api/security/agents/{agent_id}/threats
```

### Security Recommendations

```http
GET /api/security/agents/{agent_id}/recommendations
```

### Data Classification

```http
POST /api/security/agents/{agent_id}/classify
```

### Data Loss Prevention

```http
POST /api/security/agents/{agent_id}/dlp
```

### Compliance Monitoring

```http
GET /api/security/agents/{agent_id}/compliance?framework={framework}
```

## Related Documentation

- [Entra Agent Identity](docs/wiki/Entra-Agent-Identity.md) - Agent identity management
- [Foundry Control Plane](docs/wiki/Foundry-Control-Plane.md) - Observability and controls
- [Agent Registry](docs/wiki/Agent-Registry.md) - Centralized agent inventory

